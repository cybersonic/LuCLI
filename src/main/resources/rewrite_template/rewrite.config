# LuCLI URL Rewrite Rules (Tomcat RewriteValve)
# Framework-style routing through: ${routerFile}
#
# All requests that don't match static resources or CFML files
# are forwarded to the router file with the original path as PATH_INFO.
#
# Example: /hello -> /${routerFile}/hello (PATH_INFO = /hello)
#
# Documentation: https://tomcat.apache.org/tomcat-9.0-doc/rewrite.html

# Don't rewrite if accessing the router file directly
RewriteCond %{REQUEST_URI} !^/${routerFile}

# Don't rewrite static resource directories
RewriteCond %{REQUEST_URI} !^/(images|css|js|fonts|assets|static)/

# Don't rewrite static file extensions
RewriteCond %{REQUEST_URI} !\.(css|js|jpg|jpeg|png|gif|ico|svg|woff|woff2|ttf|eot|pdf|zip|json|xml|txt|map)$

# Don't rewrite Lucee admin
RewriteCond %{REQUEST_URI} !^/lucee

# Don't rewrite REST paths
RewriteCond %{REQUEST_URI} !^/rest/

# Don't rewrite CFML files accessed directly
RewriteCond %{REQUEST_URI} !\.(cfm|cfc|cfml)$

# Route everything else through the router file
RewriteRule ^/(.*)$ /${routerFile}/$1 [L]
